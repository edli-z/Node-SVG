const clipperToSvg = require("../../module/clipperToSvg")
const { toMatchCloseTo } = require('jest-matcher-deep-close-to')
expect.extend({ toMatchCloseTo })

test('clipperToSvg test', () => {
	const clipperScale = 10000000

	const polygon = [
		{
			"X": 331226536,
			"Y": 890000000
		},
		{
			"X": 338593750,
			"Y": 672500000
		},
		{
			"X": 361250000,
			"Y": 520000000
		},
		{
			"X": 393281250,
			"Y": 472500000
		},
		{
			"X": 430000000,
			"Y": 470000000
		},
		{
			"X": 461250000,
			"Y": 538750000
		},
		{
			"X": 530000000,
			"Y": 570000000
		},
		{
			"X": 598750000,
			"Y": 620000000
		},
		{
			"X": 630000000,
			"Y": 670000000
		},
		{
			"X": 605000000,
			"Y": 720000000
		},
		{
			"X": 630000000,
			"Y": 754375000
		},
		{
			"X": 730000000,
			"Y": 770000000
		},
		{
			"X": 643750000,
			"Y": 656250000
		},
		{
			"X": 615000000,
			"Y": 585000000
		},
		{
			"X": 643750000,
			"Y": 556250000
		},
		{
			"X": 730000000,
			"Y": 570000000
		},
		{
			"X": 805000000,
			"Y": 545000000
		},
		{
			"X": 830000000,
			"Y": 520000000
		},
		{
			"X": 805000000,
			"Y": 495000000
		},
		{
			"X": 653125000,
			"Y": 446875000
		},
		{
			"X": 622500000,
			"Y": 427500000
		},
		{
			"X": 638125000,
			"Y": 411875000
		},
		{
			"X": 763750000,
			"Y": 383125000
		},
		{
			"X": 785000000,
			"Y": 352500000
		},
		{
			"X": 763750000,
			"Y": 308125000
		},
		{
			"X": 700000000,
			"Y": 250000000
		},
		{
			"X": 673743687,
			"Y": 136611652
		},
		{
			"X": 611736216,
			"Y": 97921759
		},
		{
			"X": 1000000000,
			"Y": 96000000
		},
		{
			"X": 1000000000,
			"Y": 890000000
		}
	]

	const expectedOutput = [
		{
			"x": 33.1226536,
			"y": 89
		},
		{
			"x": 33.859375,
			"y": 67.25
		},
		{
			"x": 36.125,
			"y": 52
		},
		{
			"x": 39.328125,
			"y": 47.25
		},
		{
			"x": 43,
			"y": 47
		},
		{
			"x": 46.125,
			"y": 53.875
		},
		{
			"x": 53,
			"y": 57
		},
		{
			"x": 59.875,
			"y": 62
		},
		{
			"x": 63,
			"y": 67
		},
		{
			"x": 60.5,
			"y": 72
		},
		{
			"x": 63,
			"y": 75.4375
		},
		{
			"x": 73,
			"y": 77
		},
		{
			"x": 64.375,
			"y": 65.625
		},
		{
			"x": 61.5,
			"y": 58.5
		},
		{
			"x": 64.375,
			"y": 55.625
		},
		{
			"x": 73,
			"y": 57
		},
		{
			"x": 80.5,
			"y": 54.5
		},
		{
			"x": 83,
			"y": 52
		},
		{
			"x": 80.5,
			"y": 49.5
		},
		{
			"x": 65.3125,
			"y": 44.6875
		},
		{
			"x": 62.25,
			"y": 42.75
		},
		{
			"x": 63.8125,
			"y": 41.1875
		},
		{
			"x": 76.375,
			"y": 38.3125
		},
		{
			"x": 78.5,
			"y": 35.25
		},
		{
			"x": 76.375,
			"y": 30.8125
		},
		{
			"x": 70,
			"y": 25
		},
		{
			"x": 67.3743687,
			"y": 13.6611652
		},
		{
			"x": 61.1736216,
			"y": 9.7921759
		},
		{
			"x": 100,
			"y": 9.6
		},
		{
			"x": 100,
			"y": 89
		}
	]

	const output = clipperToSvg(polygon, clipperScale)
	expect(output).toMatchCloseTo(expectedOutput, 3)
});



